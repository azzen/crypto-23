from Crypto.PublicKey.RSA import import_key, RsaKey
from Crypto.Util.number import long_to_bytes

c1 = 1117464713471520760092856742380650974968064801694731457782656283801166681255111613229507025810479334694764622123718451297570426853961716946754275424809009848680479603782048148846463873037386370724463768511543202252747202410494067344036032289506842243216477301188399639121453600906709264414144995336561663702582259846004635860148299847810920447128699820457915414786746940402916100151782033085135497809304169526394416097769840212208625363843749395905939694074428072079936
pk11 = import_key("""-----BEGIN PUBLIC KEY-----
MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAlWm6dDFgADRJo57FifIt
1lrBGc2Z73tx31c8CMVfkcKlcAMQl2X9r/fcgnd66WOGMFciob3cne3UK1xiwjht
/Vc1TxxwKFXgCARg3ix9H9Lr7FkF5hQq0O/OyxXCashrdYc+em3nk5YeXyua42f1
y2jMzsfaRrKpF2OtRn7gOY9WZDDvAPLWSjte2JFHYF/oBXoMioXUps/k+O/7KzF7
tW/8Cv1eXPC4FoQZvc5IZxaLr14wglu1QPkbXkEzJrt+Dx4kQBNa0VUcYTWC2CmZ
/T4FCUk2Sm5Qi5lV2HcgfaPjL5aY4pDUyT8jYFRoiSq3IzIQ9+DYFBZB39RlWktY
1wIBAw==
-----END PUBLIC KEY-----""")

# Ex 1.1

# Known parameters:
e = 3

# In sage: m = pow(c1, 1/e)
m = pow(c1, 1/e)
print(f"Ex1.1 message: {long_to_bytes(int(m))}")

# Ex 1.2

pk12 = import_key("""-----BEGIN PUBLIC KEY-----
MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEArhwPajrS33nm7Q/dRQy8
+mYQ/FXTBfywejdynSg7wE6bfG4ecXyHV/PPyCPwHMckbPgt/kC4MzZIpVAKZLxq
8qgwGiGIrZ1trd7caG9f6l/n6SirTwQsawFNvDcmN3ifiE+gNSVN2bqzOqzhVC1p
KxiNKpPmNRK9wVrV2+pYnlO4oRHXpKWfjOgNh+esRNH1O3QRzeITN+U176j9tol/
/d5+rbFfGPnw7zkyRS7k6V9tPxrfhIm5hhm95lD79hcekHmUBEjvEXDxgPB7vhEi
8hNFFSKMFXYJDlHv3S/j8RmVh41fBE31qOMHOqSvigz8cYvM6UfuWcQTHJmUzInA
aQIBAw==
-----END PUBLIC KEY-----""")

pk13 = import_key("""-----BEGIN PUBLIC KEY-----
MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAyU48YVfVrKZnVoPcsiml
lF62ZCOf6XdYvL967L+JPQ2Jm1akFhgFaBTn8lQjQko08D6eFNhcN4qYA6hOMiWQ
4CIEdAC8mPyJxivYlMVBr5t9SdBw0vFR1bv6uGanvny+s/hqqBlWw961Z3JuOrMs
1RPTzQf4bOa6beXepnJRFB9LmMbkl8+uz7F1cZK3pPnlrQ0jjFJZTbsx4JwBU6f5
/+lqWL0qSHMIQngjv1TT9qQe3NPe9T1CzdPZGRKZRmNGy2n/NFOKGN4rm21GIUCc
G93uamgocTC6Q36LrsTtO8X+ynCOpXD+xFgp9Zm+X4ZuarWCCMsxlOae6xmbyUX6
ewIBAw==
-----END PUBLIC KEY-----""")

pk14 = import_key("""-----BEGIN PUBLIC KEY-----
MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEA8XN+6LJ0knHFufrzmfCL
gQVvJZPMgstzwjf63tVrydT1R4kIZRBumJpoO5gLlTBclyYPZaONbIYA16uufZbs
y1Ypb9/97UQwoIRJauglIQnwWJG2u+AW8qJ/WsA5DiwJaWmO6L5uH5miIBb7CA38
tSsXO6CeR1sIJ1EEC6d/KsvgfdiDBC2yceT/tFxqvWxQAmPlVEIYxDX20MKua9Pn
fVqMdqytP7G1nZ7YJ5fQwJhBxzozjqFrufoihPKKzUWepQWhShiCstu1+RQjqwO0
8rgInhkDAqWW8dQDngxe0t9p1Il3uKMjZBKtYr3O24GJH/4omtP/eQuTwRE3ZSlq
tQIBAw==
-----END PUBLIC KEY-----""")

c2 = 9432952324594491652326592192301706146809464563113761105623742080710907762919703585505894604914837843936132278279200982878554318690659686085830420602572706360790001260631403086441627682688324613411882830555802369279278836076998626669002159390629100655620228076611511665434857463164670404547850053896812061315528144131162643534963847648835667678653838016162050156268475510617040299663883981294247189470237880428176611991946112578958729715498443094998563189077885162984029415380756872755765984840837494599385733507453128482270890291180758080192901518905143351487824300879078280908779868010660581763217945693056168779469

c3 = 9193820042497834325031475627991164743293591939246500572987717810803278613605820045064734245182526713618084038252116439594115551099588015509562234147282307463246878301634418462840676726810112348437712690602555983737666482859332786458426797598816163597022296360183361000661889360128401405986065874767044474629562380820108538429851561892480741456666028836529532167387298634435797027897443292386954051926385423045092723966687230335847521672841939035275862280066625835607342180730465939463569672392166233229265155614174552098075584126943050045064850746684741002798267445392395792427143518488692117976439678609388943536773

c4 = 23983737142451755778211232244827546017868380888942332892152102063207857337745805936573886539695355986987480585062553744389247100089182724162640519963458057159725455086679812924508591479057985344728468755625379933510787033828124427720228546053645219165978363703744790558476007822197110268800522411378687540668788494385713799558815235819890682553073841669718022063220049211778052098673005830492779006168026044595872798153980844653824705937993574584803150019348271693039657069969151351662531874346960131389691532666340551054677116051836094533395026695339396306414199104536327881372792924437976394427029955941184228990388

# Solve for x using CRT
x = CRT([c2, c3, c4], [pk12.n, pk13.n, pk14.n])
print(f"Ex1.2 message: {long_to_bytes(int(pow(x, 1/e)))}")